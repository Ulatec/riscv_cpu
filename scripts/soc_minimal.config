# Minimal kernel config for Custom RV32IMA SoC
# Apply on top of allnoconfig or rv32_defconfig with overrides
# Usage: make ARCH=riscv rv32_defconfig && scripts/kconfig/merge_config.sh -m .config THIS_FILE && make ARCH=riscv olddefconfig

# === Architecture ===
CONFIG_ARCH_RV32I=y
CONFIG_NONPORTABLE=y
CONFIG_RISCV_ISA_C=y
CONFIG_MMU=y

# === Boot mode: S-mode via OpenSBI (not bare-metal M-mode) ===
# CONFIG_RISCV_M_MODE is not set
CONFIG_RISCV_SBI=y
CONFIG_RISCV_SBI_V01=y

# === Single core (NO SMP) ===
# CONFIG_SMP is not set
CONFIG_NR_CPUS=1

# === Console / UART ===
CONFIG_TTY=y
CONFIG_SERIAL_8250=y
CONFIG_SERIAL_8250_CONSOLE=y
CONFIG_SERIAL_8250_NR_UARTS=1
CONFIG_SERIAL_EARLYCON=y
CONFIG_SERIAL_8250_EARLY_CON=y
CONFIG_SERIAL_OF_PLATFORM=y

# === SBI Console (reliable fallback via ecalls) ===
CONFIG_HVC_DRIVER=y
CONFIG_HVC_RISCV_SBI=y

# === Early output ===
CONFIG_EARLY_PRINTK=y
CONFIG_PRINTK=y
CONFIG_PRINTK_TIME=y
CONFIG_CONSOLE_LOGLEVEL_DEFAULT=8
CONFIG_MESSAGE_LOGLEVEL_DEFAULT=7

# === Initramfs ===
CONFIG_BLK_DEV_INITRD=y
CONFIG_INITRAMFS_SOURCE="/work/initramfs.cpio"

# === Device tree ===
CONFIG_OF=y

# === Minimal filesystem ===
CONFIG_PROC_FS=y
CONFIG_SYSFS=y
CONFIG_TMPFS=y
CONFIG_DEVTMPFS=y
CONFIG_DEVTMPFS_MOUNT=y

# === Timer ===
CONFIG_HZ_100=y
CONFIG_RISCV_TIMER=y
CONFIG_GENERIC_CLOCKEVENTS=y

# === Disable heavy subsystems ===
# CONFIG_SMP is not set
# CONFIG_NET is not set
# CONFIG_WIRELESS is not set
# CONFIG_PCI is not set
# CONFIG_PCCARD is not set
# CONFIG_INPUT is not set
# CONFIG_SERIO is not set
# CONFIG_HID is not set
# CONFIG_USB_SUPPORT is not set
# CONFIG_USB is not set
# CONFIG_SOUND is not set
# CONFIG_FB is not set
# CONFIG_DRM is not set
# CONFIG_VGA_CONSOLE is not set
# CONFIG_DUMMY_CONSOLE is not set
# CONFIG_BACKLIGHT_CLASS_DEVICE is not set
# CONFIG_LEDS_CLASS is not set
# CONFIG_BPF_SYSCALL is not set
# CONFIG_MODULES is not set
# CONFIG_PROFILING is not set
# CONFIG_VIRTUALIZATION is not set
# CONFIG_KVM is not set
# CONFIG_SYSVIPC is not set
# CONFIG_POSIX_MQUEUE is not set
# CONFIG_NAMESPACES is not set
# CONFIG_CGROUPS is not set
# CONFIG_CHECKPOINT_RESTORE is not set
# CONFIG_BLOCK is not set
# CONFIG_EXPERT is not set
# CONFIG_MISC_FILESYSTEMS is not set
# CONFIG_NETWORK_FILESYSTEMS is not set
# CONFIG_NFS_FS is not set
# CONFIG_IKCONFIG is not set
# CONFIG_SECCOMP is not set
# CONFIG_STACKPROTECTOR is not set
# CONFIG_CRYPTO is not set

# === Reduce kernel size ===
# CONFIG_DEBUG_INFO is not set
# CONFIG_KALLSYMS is not set
# CONFIG_SWAP is not set

# === SoC support (minimal) ===
# CONFIG_SOC_SIFIVE is not set
# CONFIG_SOC_VIRT is not set
